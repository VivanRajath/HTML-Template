<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Birthday Moon Flight</title>
    <link rel="stylesheet" href="style.css">

</head>

<body>
    <!-- Stars -->
    <div class="stars-container"></div>

    <!-- Image Upload Area -->
    <div class="image-upload-area" id="uploadArea" >
        <div>ðŸ“· Tap to add character image</div>
        <input type="file" id="imageInput" accept="image/*">
    </div>

    <!-- Moon -->
    <div class="moon"></div>

    <!-- Character -->
    <div class="character" id="character">
        <img src="char.png" alt="Character" class="character-img" id="characterImg">
    </div>

    <!-- Jump Button -->
    <button class="jump-btn" id="jumpBtn">click nd touch the moon</button>

    <!-- Birthday Message -->
    <div class="birthday-message" id="birthdayMessage"></div>

    <!-- Reset Button -->
    <button class="reset-btn" id="resetBtn">ðŸ”„ Play Again</button>

    <script>
        const character = document.getElementById('character');
        const characterImg = document.getElementById('characterImg');
        const jumpBtn = document.getElementById('jumpBtn');
        const birthdayMessage = document.getElementById('birthdayMessage');
        const resetBtn = document.getElementById('resetBtn');
        const moon = document.querySelector('.moon');
        const uploadArea = document.getElementById('uploadArea');
        const imageInput = document.getElementById('imageInput');

        let isJumping = false;
        let velocity = 0;
        let positionY = 0;
        let gravity = 0.8;
        let jumpCount = 0;
        let baseJumpForce = 8;
        let animationFrame;
        let groundY = 0;
        let moonReached = false;

        // Position character at bottom initially
        function positionCharacterAtBottom() {
            groundY = window.innerHeight - character.offsetHeight - (window.innerHeight * 0.05);
            positionY = groundY;
            character.style.top = positionY + 'px';
        }

        // Handle image upload
        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    // Update the existing image src
                    characterImg.src = e.target.result;
                    
                    // Update upload area
                    uploadArea.classList.add('has-image');
                    uploadArea.innerHTML = '<div>âœ… Image loaded!</div>';
                    
                    // Hide upload area after 2 seconds
                    setTimeout(() => {
                        uploadArea.style.opacity = '0.3';
                        uploadArea.style.transform = 'scale(0.8)';
                    }, 2000);
                };
                reader.readAsDataURL(file);
            }
        }

        // Create stars with responsive sizing
        function createStars() {
            const starsContainer = document.querySelector('.stars-container');
            const starCount = window.innerWidth < 768 ? 30 : 50; // Fewer stars on mobile
            
            for (let i = 0; i < starCount; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                const size = Math.random() * 3 + 1;
                star.style.width = size + 'px';
                star.style.height = size + 'px';
                star.style.animationDelay = Math.random() * 2 + 's';
                starsContainer.appendChild(star);
            }
        }

        // Create particles effect
        function createParticles(x, y, count = 10) {
            // Reduce particle count on mobile for performance
            const particleCount = window.innerWidth < 768 ? Math.ceil(count / 2) : count;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = x + 'px';
                particle.style.top = y + 'px';
                document.body.appendChild(particle);

                const angle = (Math.PI * 2 * i) / particleCount;
                const velocity = 2 + Math.random() * 3;
                let posX = x;
                let posY = y;
                let opacity = 1;

                const animate = () => {
                    posX += Math.cos(angle) * velocity;
                    posY += Math.sin(angle) * velocity + 0.5;
                    opacity -= 0.02;

                    particle.style.left = posX + 'px';
                    particle.style.top = posY + 'px';
                    particle.style.opacity = opacity;

                    if (opacity > 0) {
                        requestAnimationFrame(animate);
                    } else {
                        particle.remove();
                    }
                };
                animate();
            }
        }

        // Create confetti
        function createConfetti() {
            const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#ffd93d', '#ff9ff3'];
            const confettiCount = window.innerWidth < 768 ? 20 : 30; // Fewer confetti on mobile
            
            for (let i = 0; i < confettiCount; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animationDelay = Math.random() * 2 + 's';
                    document.body.appendChild(confetti);

                    setTimeout(() => confetti.classList.add('active'), 10);
                    setTimeout(() => confetti.remove(), 3000);
                }, i * 100);
            }
        }

        // Show birthday message letter by letter
        function showBirthdayMessage() {
            const message = "HAPPY 22 Yrs    10 Months Birthday!!";
            birthdayMessage.innerHTML = '';
            birthdayMessage.style.opacity = '1';

            message.split('').forEach((letter, index) => {
                const letterSpan = document.createElement('span');
                letterSpan.className = 'letter';
                letterSpan.textContent = letter === ' ' ? '\u00A0' : letter;
                birthdayMessage.appendChild(letterSpan);

                setTimeout(() => {
                    letterSpan.classList.add('show');
                    letterSpan.style.animationDelay = (index * 0.2) + 's';
                    const rect = letterSpan.getBoundingClientRect();
                    createParticles(rect.left + rect.width / 2, rect.top + rect.height / 2, 5);
                }, index * 200);
            });

            setTimeout(() => {
                createConfetti();
                resetBtn.classList.add('show');
            }, message.length * 200 + 500);
        }

        // Jump with cumulative height
        function jump() {
            if (isJumping || moonReached) return;

            jumpCount++;
            const jumpForce = baseJumpForce * jumpCount;
            velocity = -jumpForce;
            
            isJumping = true;
            character.classList.add('jumping');

            const jumpAnimation = () => {
                velocity += gravity;
                positionY += velocity;

                // Get moon and character positions (responsive)
                const moonRect = moon.getBoundingClientRect();
                const charRect = character.getBoundingClientRect();
                
                const moonCenterX = moonRect.left + moonRect.width / 2;
                const moonCenterY = moonRect.top + moonRect.height / 2;
                const charCenterX = charRect.left + charRect.width / 2;
                const charCenterY = charRect.top + charRect.height / 2;

                const distance = Math.sqrt(Math.pow(moonCenterX - charCenterX, 2) + Math.pow(moonCenterY - charCenterY, 2));

                if (distance < (moonRect.width / 2 + charRect.width / 2 + 20) && !moonReached) {
                    moonReached = true;
                    character.classList.add('reached-moon');
                    moon.style.animation = 'bounce 0.5s ease-in-out 3';
                    createParticles(moonCenterX, moonCenterY, 15);

                    setTimeout(() => {
                        showBirthdayMessage();
                    }, 500);

                    cancelAnimationFrame(animationFrame);
                    character.classList.remove('jumping');
                    return;
                }

                if (positionY >= groundY) {
                    positionY = groundY;
                    velocity = 0;
                    isJumping = false;
                    character.classList.remove('jumping');
                    character.style.top = positionY + 'px';
                    
                    cancelAnimationFrame(animationFrame);
                    return;
                }

                character.style.top = positionY + 'px';
                animationFrame = requestAnimationFrame(jumpAnimation);
            };

            jumpAnimation();
        }

        // Reset game
        function resetGame() {
            moonReached = false;
            isJumping = false;
            velocity = 0;
            jumpCount = 0;
            cancelAnimationFrame(animationFrame);

            character.classList.remove('jumping', 'reached-moon');
            jumpBtn.textContent = 'ðŸš€ Jump!';
            birthdayMessage.style.opacity = '0';
            birthdayMessage.innerHTML = '';
            resetBtn.classList.remove('show');
            moon.style.animation = '';

            positionCharacterAtBottom();
            document.querySelectorAll('.particle, .confetti').forEach(el => el.remove());
        }

        // Bounce animation keyframe for moon
        const style = document.createElement('style');
        style.textContent = `
            @keyframes bounce {
                0%, 100% { transform: scale(1); }
                50% { transform: scale(1.2); }
            }
        `;
        document.head.appendChild(style);

        // Event listeners
        jumpBtn.addEventListener('click', jump);
        jumpBtn.addEventListener('touchstart', (e) => {
            e.preventDefault();
            jump();
        });

        resetBtn.addEventListener('click', resetGame);
        resetBtn.addEventListener('touchstart', (e) => {
            e.preventDefault();
            resetGame();
        });

        uploadArea.addEventListener('click', () => {
            imageInput.click();
        });

        imageInput.addEventListener('change', handleImageUpload);

        // Handle window resize
        window.addEventListener('resize', () => {
            if (!isJumping && !moonReached) {
                positionCharacterAtBottom();
            }
        });

        // Moon hover/touch effect
        moon.addEventListener('mouseenter', () => {
            if (!moonReached) {
                const rect = moon.getBoundingClientRect();
                createParticles(rect.left + rect.width/2, rect.top + rect.height/2, 8);
            }
        });

        moon.addEventListener('touchstart', (e) => {
            e.preventDefault();
            if (!moonReached) {
                const rect = moon.getBoundingClientRect();
                createParticles(rect.left + rect.width/2, rect.top + rect.height/2, 8);
            }
        });

        // Initialize game
        createStars();
        positionCharacterAtBottom();

        // Prevent default touch behaviors
        document.addEventListener('touchstart', (e) => {
            if (e.target.tagName !== 'INPUT') {
                e.preventDefault();
            }
        }, { passive: false });

        document.addEventListener('touchmove', (e) => {
            e.preventDefault();
        }, { passive: false });
    </script>

</body>

</html>