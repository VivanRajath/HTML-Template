<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Fishing Treasure Game</title>
    <link rel="stylesheet" href="style.css">

</head>

<body>
    <div class="game-container">
        <!-- Sun and clouds -->
        <div class="sun"></div>
        <div class="clouds">‚òÅÔ∏è</div>

        <!-- Ocean and Waves -->
        <div class="waves">
            <div class="wave"></div>
            <div class="wave"></div>
        </div>

        <!-- Swimming fish -->
        <div class="fish">üêü</div>

        <!-- Bubbles -->
        <div class="bubbles" id="bubbles"></div>

        <!-- Boat with Fisherman -->
        <div class="boat">
            <div class="boat-body">
                <div class="boat-deck"></div>
            </div>
            <div class="fisherman">
                <div class="fisherman-hat"></div>
                <div class="fisherman-head"></div>
                <div class="fisherman-body"></div>
            </div>
            <div class="fishing-rod"></div>
        </div>

        <!-- Fishing Line -->
        <div class="fishing-line" id="fishingLine">
            <div class="hook"></div>
        </div>

        <!-- Treasure -->
        <div class="treasure" id="treasure"></div>

        <!-- Catch Zone -->
        <div class="catch-zone" id="catchZone"></div>

        <!-- Pull Progress -->
        <div class="pull-progress" id="pullProgress">
            <div class="progress-bar" id="progressBar"></div>
        </div>

        <!-- Instructions -->
        <div class="instruction" id="instruction">
            Watch the line sway and tap when it's over the treasure!
        </div>
    </div>

    <!-- 3D Lock Screen -->
    <div class="lock-screen" id="lockScreen">
        <div class="sparkles" id="sparkles"></div>
        <div class="chest-container">
            <div class="treasure-chest-3d">
                <div class="chest-body"></div>
                <div class="chest-lid" id="chestLid"></div>
                <div class="chest-lock">
                    <div class="lock-body">
                        <div class="lock-shackle"></div>
                        <div class="keyhole"></div>
                    </div>
                </div>
            </div>
            <div class="lock-question" id="lockQuestion">Who is your favorite person?</div>
            <input type="text" class="lock-input" id="lockInput" placeholder="Enter your answer...">
            <button type="button" class="lock-button" id="unlockBtn">üóùÔ∏è Unlock Treasure</button>
            <div class="wrong-answer" id="wrongAnswer">Try again! Think of a nickname...</div>
        </div>
    </div>

    <!-- Victory Screen -->
    <div class="victory-screen" id="victoryScreen">
        <div class="message-container" id="messageContainer">
            <div class="hearts-static">üíï‚ù§Ô∏èüíï</div>
        </div>
        <div class="floating-hearts" id="floatingHearts"></div>
    </div>

    <script>
        let gameState = 'fishing'; // fishing, pulling, locked, victory
        let swayDirection = 1;
        let linePosition = 50;
        let pullProgress = 0;
        let lockAttempts = 0;

        const fishingLine = document.getElementById('fishingLine');
        const treasure = document.getElementById('treasure');
        const catchZone = document.getElementById('catchZone');
        const instruction = document.getElementById('instruction');
        const pullProgressBar = document.getElementById('pullProgress');
        const progressBar = document.getElementById('progressBar');
        const lockScreen = document.getElementById('lockScreen');
        const lockQuestion = document.getElementById('lockQuestion');
        const lockInput = document.getElementById('lockInput');
        const wrongAnswer = document.getElementById('wrongAnswer');
        const chestLid = document.getElementById('chestLid');
        const sparkles = document.getElementById('sparkles');
        const victoryScreen = document.getElementById('victoryScreen');
        const messageContainer = document.getElementById('messageContainer');
        const unlockBtn = document.getElementById('unlockBtn');

        // Initialize game
        function initGame() {
            // Position treasure randomly
            const treasureX = Math.random() * (window.innerWidth - 100) + 50;
            treasure.style.left = treasureX + 'px';

            // Position catch zone over treasure
            catchZone.style.left = (treasureX - 10) + 'px';
            catchZone.style.bottom = '8%';
            catchZone.style.display = 'block';

            // Start line swaying
            swayLine();

            // Create bubbles
            setInterval(createBubble, 800);
        }

        // Line swaying animation
        function swayLine() {
            if (gameState !== 'fishing') return;

            linePosition += swayDirection * 1.5;

            if (linePosition >= 85 || linePosition <= 15) {
                swayDirection *= -1;
            }

            fishingLine.style.left = linePosition + '%';
            fishingLine.style.height = '45%';

            requestAnimationFrame(swayLine);
        }

        // Create bubbles
        function createBubble() {
            const bubble = document.createElement('div');
            bubble.className = 'bubble';
            bubble.style.left = Math.random() * 100 + '%';
            bubble.style.width = bubble.style.height = Math.random() * 15 + 8 + 'px';
            bubble.style.animationDelay = Math.random() * 2 + 's';
            document.getElementById('bubbles').appendChild(bubble);

            setTimeout(() => {
                if (bubble.parentNode) {
                    bubble.parentNode.removeChild(bubble);
                }
            }, 4000);
        }

        // Create sparkles
        function createSparkle() {
            const sparkle = document.createElement('div');
            sparkle.className = 'sparkle';
            sparkle.textContent = '‚ú®';
            sparkle.style.left = Math.random() * 100 + '%';
            sparkle.style.top = Math.random() * 100 + '%';
            sparkle.style.animationDelay = Math.random() * 2 + 's';
            sparkles.appendChild(sparkle);

            setTimeout(() => {
                if (sparkle.parentNode) {
                    sparkle.parentNode.removeChild(sparkle);
                }
            }, 2000);
        }

        // Touch/Click handler for fishing
        document.addEventListener('touchstart', handleTouch, { passive: false });
        document.addEventListener('click', handleTouch);

        function handleTouch(e) {
            // If the touch/click is on the lock screen controls, let them work normally
            if (e.target.closest('#lockScreen') || e.target.closest('#unlockBtn') || e.target.closest('#lockInput')) {
                return;
            }

            // Prevent default only for game touches
            e.preventDefault();

            if (gameState === 'fishing') {
                checkCatch();
            } else if (gameState === 'pulling') {
                pullTreasure();
            }
        }

        // Check if line is over treasure
        function checkCatch() {
            const lineRect = fishingLine.getBoundingClientRect();
            const zoneRect = catchZone.getBoundingClientRect();

            const lineX = lineRect.left + lineRect.width / 2;
            const zoneX = zoneRect.left + zoneRect.width / 2;

            if (Math.abs(lineX - zoneX) < 50) {
                // Successful catch!
                gameState = 'pulling';
                instruction.textContent = 'Keep tapping to pull up the treasure!';
                catchZone.style.display = 'none';
                pullProgressBar.style.display = 'block';

                // Animate treasure moving to hook
                treasure.style.bottom = '45%';
                treasure.style.left = (linePosition - 2) + '%';
            } else {
                // Miss - shake the screen briefly
                document.body.style.animation = 'shake 0.3s ease-in-out';
                setTimeout(() => {
                    document.body.style.animation = '';
                }, 300);
            }
        }

        // Pull treasure progress
        function pullTreasure() {
            pullProgress += 6;
            progressBar.style.width = pullProgress + '%';

            // Move treasure higher as progress increases
            const newBottom = 30 + (pullProgress / 100) * 25;
            treasure.style.bottom = newBottom + '%';

            if (pullProgress >= 100) {
                gameState = 'locked';
                instruction.style.display = 'none';
                pullProgressBar.style.display = 'none';
                lockScreen.style.display = 'flex';

                // Hide treasure from main screen
                treasure.style.display = 'none';

                // Start creating sparkles
                setInterval(createSparkle, 300);
            }
        }

        // Check lock answer
        function checkAnswer() {
            const answer = lockInput.value.trim().toLowerCase();

            if (answer === 'bubbuu' || answer === 'bubbu') {
                wrongAnswer.style.display = 'none';

                // Animate chest opening
                chestLid.classList.add('unlock-animation');

                setTimeout(() => {
                    openTreasure();
                }, 1000);
            } else {
                lockAttempts++;
                lockInput.value = '';
                wrongAnswer.style.display = 'block';

                if (lockAttempts === 1) {
                    lockQuestion.textContent = "Hmm, try his nickname...";
                    wrongAnswer.textContent = "Think of someone special... üíï";
                } else if (lockAttempts === 2) {
                    lockQuestion.textContent = "Hint: B_bb_u";
                    wrongAnswer.textContent = "You're getting closer! Fill in the blanks...";
                } else if (lockAttempts >= 3) {
                    lockQuestion.textContent = "Just type: Bubbuu";
                    wrongAnswer.textContent = "Here's the answer! Type it exactly...";
                }

                // Shake animation for wrong answer
                document.querySelector('.chest-container').style.animation = 'none';
                setTimeout(() => {
                    document.querySelector('.chest-container').style.animation = 'chestFloat 3s ease-in-out infinite';
                }, 100);
            }
        }

        // ‚úÖ Unlock button listeners (works on mobile too)
        unlockBtn.addEventListener('click', checkAnswer);
        unlockBtn.addEventListener('touchend', (ev) => {
            ev.stopPropagation();
            checkAnswer();
        });

        // Open treasure and show victory
        function openTreasure() {
            gameState = 'victory';
            lockScreen.style.display = 'none';
            victoryScreen.style.display = 'flex';

            // Create animated message with better spacing
            const messages = [
                "Happyy 22yrs",
                "11months",
                "anniversaryyy",
                "1 more month",
                "to goooo! üíï"
            ];

            messages.forEach((msg, index) => {
                setTimeout(() => {
                    const messageEl = document.createElement('div');
                    messageEl.className = 'message';
                    messageEl.textContent = msg;
                    messageEl.style.animationDelay = (index * 0.2) + 's';
                    messageContainer.appendChild(messageEl);
                }, index * 500);
            });

            // Create floating hearts
            createFloatingHearts();
        }

        // Create floating hearts animation
        function createFloatingHearts() {
            const heartsContainer = document.getElementById('floatingHearts');

            setInterval(() => {
                const heart = document.createElement('div');
                heart.className = 'heart';
                heart.innerHTML = ['üíï', '‚ù§Ô∏è', 'üíñ', 'üíù'][Math.floor(Math.random() * 4)];
                heart.style.left = Math.random() * 100 + '%';
                heart.style.animationDuration = (Math.random() * 2 + 3) + 's';
                heartsContainer.appendChild(heart);

                // Remove heart after animation
                setTimeout(() => {
                    if (heart.parentNode) {
                        heart.remove();
                    }
                }, 5000);
            }, 600);
        }

        // Add shake animation to CSS
        const style = document.createElement('style');
        style.textContent = `
    @keyframes shake {
        0%, 100% { transform: translateX(0); }
        25% { transform: translateX(-8px); }
        75% { transform: translateX(8px); }
    }
`;
        document.head.appendChild(style);

        // Start game
        initGame();

        // Prevent zoom on mobile
        document.addEventListener('touchmove', function (e) {
            if (e.scale !== 1) {
                e.preventDefault();
            }
        }, { passive: false });

        // Prevent double-tap zoom
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function (e) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                e.preventDefault();
            }
            lastTouchEnd = now;
        });

        // Prevent context menu
        document.addEventListener('contextmenu', function (e) {
            e.preventDefault();
        });

        // Focus input when lock screen appears
        const observer = new MutationObserver(function (mutations) {
            mutations.forEach(function (mutation) {
                if (mutation.target.id === 'lockScreen' &&
                    mutation.target.style.display === 'flex') {
                    setTimeout(() => {
                        lockInput.focus();
                    }, 500);
                }
            });
        });

        observer.observe(lockScreen, {
            attributes: true,
            attributeFilter: ['style']
        });
    </script>

</body>

</html>